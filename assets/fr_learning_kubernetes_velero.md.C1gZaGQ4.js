import{_ as t,D as a,c as r,j as e,I as i,a as n,a1 as o,o as l,aI as d}from"./chunks/framework.CgL1aY5S.js";const _=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"fr/learning/kubernetes/velero.md","filePath":"fr/learning/kubernetes/velero.md"}'),u={name:"fr/learning/kubernetes/velero.md"},c={id:"",tabindex:"-1"},p=e("a",{class:"header-anchor",href:"#","aria-label":`Permalink to "<KubernetesIcon icon='/clusters/learning/kubernetes/icons/velero.png' label='Velero' :width='45' :height='45' />"`},"​",-1),g=o(`<p><a href="https://velero.io/" target="_blank" rel="noreferrer">Velero</a> est un outil open source conçu pour <strong>sauvegarder et restaurer</strong> en toute sécurité, assurer la <strong>reprise après sinistre</strong>, et <strong>migrer les ressources des clusters</strong> Kubernetes ainsi que les volumes persistants. Il répond également aux besoins de continuité des activités et de reprise après sinistre (<code>BCDR</code> - Business Continuity and Disaster Recovery).</p><h2 id="avantages" tabindex="-1">Avantages <a class="header-anchor" href="#avantages" aria-label="Permalink to &quot;Avantages&quot;">​</a></h2><p>Velero étend les API Kubernetes pour gérer les <strong>opérations de sauvegarde et de restauration</strong>. Chaque opération est définie par des Custom Resource Definitions (<code>CRD</code>) dans Kubernetes et est stockée dans <code>ETCD</code>. Velero permet de <strong>sauvegarder tous les objets du cluster ou de filtrer</strong> par namespace, label ou type.</p><table><thead><tr><th><strong>Fonctionnalité</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>Opérations de sauvegarde</strong></td><td>Permet de configurer des intervalles de sauvegarde avant ou après l&#39;exécution des sauvegardes. Par exemple, il est possible de vidanger la base de données avant de démarrer une sauvegarde, ce qui peut être essentiel pour garantir l&#39;intégrité des données.</td></tr><tr><td><strong>Stockage basé sur le cloud</strong></td><td>Velero conserve la sauvegarde des objets Kubernetes sous forme d&#39;archive dans un stockage cloud.</td></tr><tr><td><strong>Instantanés de volumes persistants</strong></td><td>Velero crée des instantanés de disque des volumes persistants en interagissant avec l&#39;API du fournisseur de cloud.</td></tr><tr><td><strong>Sauvegardes planifiées</strong></td><td>Les sauvegardes peuvent être déclenchées manuellement ou programmées à intervalles réguliers via des tâches Cron.</td></tr><tr><td><strong>Opérations de restauration</strong></td><td>Permet de restaurer des objets et des volumes persistants à partir des sauvegardes, avec la possibilité de restaurer un sous-ensemble spécifique.</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Par défaut, Velero permet de restaurer des objets dans différents namespaces. Il est également possible d&#39;intégrer des événements avant ou après les opérations de restauration, comme le redémarrage de conteneurs d&#39;applications après la restauration d&#39;une base de données.</p></div><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/vmware-tanzu/velero/releases/download/v1.10.0/velero-v1.10.0-linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero-v1.10.0-linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero-v1.10.0-linux-amd64/velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span></span></code></pre></div><h2 id="workflow-de-sauvegarde" tabindex="-1">Workflow de sauvegarde <a class="header-anchor" href="#workflow-de-sauvegarde" aria-label="Permalink to &quot;Workflow de sauvegarde&quot;">​</a></h2><p><img src="`+d+'" alt="velero-backup"></p><ol><li>Le processus de sauvegarde commence lorsque le client Velero appelle l&#39;API Kubernetes pour créer un objet de sauvegarde. Par défaut, <code>velero backup create</code> génère des instantanés de disque des volumes persistants.</li><li>Le contrôleur de sauvegarde détecte cette demande et lance le processus de validation.</li><li>Une fois validée, la sauvegarde est déclenchée. Pour sauvegarder les objets, Velero interagit avec le serveur API de Kubernetes pour collecter les données.</li><li>Il communique également avec le service de stockage du fournisseur de cloud pour télécharger le fichier de sauvegarde.</li></ol><div class="tip custom-block"><p class="custom-block-title">Pour découvrir toutes les options disponibles :</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> —</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help</span></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">Désactiver les instantanés de volumes avec l&#39;option suivante :</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--snapshot-volumes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">false</span></span></code></pre></div></div><h2 id="synchronisation-de-stockage-d-objets" tabindex="-1">Synchronisation de stockage d&#39;objets <a class="header-anchor" href="#synchronisation-de-stockage-d-objets" aria-label="Permalink to &quot;Synchronisation de stockage d&#39;objets&quot;">​</a></h2><p>Velero considère le stockage cloud comme source de vérité. Il assure que l&#39;état des ressources de sauvegarde dans Kubernetes reflète celui du stockage cloud. Si un objet de sauvegarde est présent dans Kubernetes mais absent du stockage cloud, il sera synchronisé, et inversement, s&#39;il est absent de Kubernetes, il sera supprimé.</p><p>Cette fonctionnalité est particulièrement utile lors de la migration de clusters. Elle g<strong>arantit que les ressources de sauvegarde restent cohérentes entre Kubernetes et le stockage cloud</strong>.</p><h2 id="utilisation-de-velero-avec-aws-s3" tabindex="-1">Utilisation de Velero avec AWS S3 <a class="header-anchor" href="#utilisation-de-velero-avec-aws-s3" aria-label="Permalink to &quot;Utilisation de Velero avec AWS S3&quot;">​</a></h2><p>La <strong>sauvegarde régulière des clusters Kubernetes est cruciale</strong> pour une reprise après sinistre efficace. La fréquence des sauvegardes doit être adaptée aux besoins spécifiques de chaque organisation.</p><p>Velero permet de <strong>configurer des sauvegardes vers des services de stockage cloud comme AWS S3</strong>. Amazon Simple Storage Service (S3) est un service de stockage en nuage offrant une haute disponibilité et une sécurité renforcée. Il permet de stocker et de récupérer une quantité illimitée de données via une interface web ou des API.</p><p>AWS S3 utilise des compartiments pour stocker des objets, offrant ainsi une structure de stockage flexible et extensible. Bien que S3 ait une structure hiérarchique simple, les entreprises peuvent configurer une organisation plus complexe en utilisant les fonctionnalités de gestion d&#39;objets avancées.</p><p>Avec les <a href="https://velero.io/plugins/" target="_blank" rel="noreferrer">plugins Velero</a>, vous pouvez sauvegarder votre cluster Kubernetes non seulement sur AWS S3, mais également sur d&#39;autres fournisseurs de cloud tels que GCP, Azure, Alibaba, DigitalOcean, etc.</p><p>Velero est une solution couramment utilisée pour mettre en place des plans de reprise d&#39;activités (BCDR) pour les clusters Kubernetes. AWS S3, avec ses garanties de haute disponibilité, complète Velero en offrant un stockage fiable pour les sauvegardes d&#39;<code>ETCD</code>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Pour plus de détails sur la configuration de Velero avec AWS S3, consultez la documentation officielle : <a href="https://velero.io/docs/v1.0.0/aws-config/." target="_blank" rel="noreferrer">Velero AWS Configuration</a>.</p></div>',22);function h(v,k,b,m,f,F){const s=a("KubernetesIcon");return l(),r("div",null,[e("h1",c,[i(s,{icon:"/clusters/learning/kubernetes/icons/velero.png",label:"Velero",width:45,height:45}),n(),p]),g])}const y=t(u,[["render",h]]);export{_ as __pageData,y as default};
